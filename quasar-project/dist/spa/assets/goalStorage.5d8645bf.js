import{bT as k,r as w,c as g}from"./index.8a609466.js";import{u as U}from"./use-quasar.ec58d98a.js";const C=k("allGoals",()=>{const h=w([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),d=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],n=U(),m=g(()=>d),G=g(()=>{let e=JSON.parse(n.localStorage.getItem("mainGoals"));return v(e)}),b=g(()=>{let e=JSON.parse(n.localStorage.getItem("subGoals"));return v(e)}),p=g(()=>JSON.parse(n.localStorage.getItem("AllDates")));function v(e){return e?[...e]:[]}function y(e,t,l,o){console.log(e.value+" "+t.value+" "+l.value+" "+o.value);let a=this.getMainGoals;if(!a){console.log("umm no mainGoals...adding"),n.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.value,details:t.value,priority:o.value,bgcolor:l.value,icon:"fas fa-utensils"}]));return}let r=a.length+1;for(;a.some(i=>i.id===r);)r=Math.floor(Math.random()*1e3);a.unshift({id:r,title:e.value,details:t.value,priority:o.value,bgcolor:l.value,icon:"fas fa-utensils"}),n.localStorage.set("mainGoals",JSON.stringify(a)),console.log("done adding mainGoal")}function D(e,t,l,o,a,r){console.log(e+" "+t.value+" "+l.value+" "+o.value+" "+a.value+" "+r.value);let i=this.getSubGoals;if(!i){n.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:t.value,score:l.value,time:o.value,duration:a.value,canMove:r.value}]));return}let s=i.length+1;for(;i.some(u=>u.id===s);)s=Math.floor(Math.random()*1e3);i.unshift({id:s,parentGoal:e,title:t.value,score:l.value,time:o.value,duration:a.value,canMove:r.value}),n.localStorage.set("subGoals",JSON.stringify(i))}function O(e,t,l,o,a,r){let i=this.getSubGoals;i.forEach(s=>{s.id===e&&(s.title=t.value,s.score=l.value,s.time=o.value,s.duration=a.value,s.canMove=r.value,console.log("editSubGoal for",s))}),n.localStorage.set("subGoals",JSON.stringify(i))}function x(){n.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function A(){n.localStorage.remove("subGoals"),console.log("removed all subGoals")}function N(){n.localStorage.remove("subGoals"),n.localStorage.remove("mainGoals"),console.log("removed ALL")}function I(e,t=null,l=null){let o=this.getSubGoals;o.forEach(a=>{a.id===e&&(a.time=t||a.time,a.score=l||a.score)}),n.localStorage.set("subGoals",JSON.stringify(o))}function M(e){let t=this.getSubGoals;for(var l=0;l<t.length;l++)t[l].id===e&&(t.splice(l,1),console.log("removeSubgoal spliced!"));return n.localStorage.set("subGoals",JSON.stringify(t)),t}function J(e,t){let l=this.getMainGoals;for(var o=0;o<l.length;o++)l[o].id===e&&(l.splice(o,1),console.log("removeMaingoal spliced!"));return n.localStorage.set("mainGoals",JSON.stringify(l)),l}function T(e,t){let l=this.getAllDates;l?(l[`${e}`]=t,n.localStorage.set("AllDates",JSON.stringify(l))):(console.log(`Adding new schedule for ${e}`),l={},l[`${e}`]=t,n.localStorage.set("AllDates",JSON.stringify(l)))}function E(e){let t=this.getAllDates;if(t)return t[`${e}`]}function R(e){let t=this.getAllDates;return t?!!t[`${e}`]:!1}function $(e){const t=[];let l=function(a){const r=a.split(/on/);return r.length!=2?(console.log(`parseScore error?${a}`,r),-1):r[1]-r[0]},o=this.getSubGoals;return o&&o.forEach(a=>{if(a.score=="")console.log(`no score event added: ${a.title}`,a.score),t.push(a);else{let r=l(a.score);r>-1&&r>=e&&t.push(a)}}),t}function F(e){const l=(e/60).toFixed(2);return parseFloat(l)}function L(){let e=this.getAllDates;if(!e)return console.log("no savedTaskSummary..ERROR"),[];let t=this.getMainGoals,l=this.getSubGoals,o={};for(let s in e){let u=e[s];for(let c in u)o[c]||(o[c]=[]),o[c].push({date:s,logged:F(u[c].duration)})}let a=s=>{let u=[];return l&&l.forEach(c=>{c.parentGoal==s&&u.push(c)}),u},r=(s,u=null)=>{let c={children:[],title:s.title,key:u?`${u}-${s.id}`:s.id,logged:[],expanded:!1};if(u){let f=o[s.id]||[];c.logged=[...f]}return c},i=[];return t.forEach(s=>{let u=r(s),c=a(s.id);for(let f=0;f<c.length;f++){let S=r(c[f],s.id);u.logged.push(...S.logged),u.children.push(S)}i.push(u)}),i}return{headers:d,headerRefs:h,getHeaders:m,getMainGoals:G,getSubGoals:b,getAllDates:p,addMainGoal:y,addSubGoal:D,editSubGoal:O,saveSubProp:I,saveDailySchedule:T,resetSub:A,resetMain:x,resetAll:N,removeSubgoal:M,removeMaingoal:J,getEventsForDate:E,hasEventsForDate:R,fetchAllTaskSummary:L,fetchGoalsWithMinScore:$}});export{C as u};
